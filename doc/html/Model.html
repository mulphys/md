<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>ReMoDy: Model</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="Model">Model </a></h1><h2><a class="anchor" name="SecModel">
Physical Model</a></h2>
The physical model of ReMoDy is uses the <a href="http://en.wikipedia.org/wiki/Collision_theory">Collision_theory</a> to describe elementary chemical reactions, and <a href="http://en.wikipedia.org/wiki/Kinetic_theory">Kinetic theory</a> to describe molecular gas dynamics. Reactions occur probabilistically during molecular collisions, with the probabilities determined by the activation energies and reaction probabilities, if more than one outcome for the reaction exists.<p>
The thermodynamic properties of the gas species include <a href="http://en.wikipedia.org/wiki/Heat_capacity">heat capacities</a> which are used to distribute thermal energy among molecular degrees of freedom during the collisions.<h3><a class="anchor" name="SReact">
Chemical Reactions</a></h3>
The interaction of the two molecules is modeled through the binary collision approximation whereby only two molecules can interact at a time. The interaction between the molecules can be of two kinds: (1) simple mechanical collision, (2) collision with subsequent chemical reaction. The fact of the collision is detected when the distance between the centers of two molecules becomes less than the sum of their radii, and their relative velocities are directed toward each-other.<p>
Collision is modeled in the center-of-mass (CM) frame of reference. The velocities of the two molecules are first recalculated into the CM frame. The total energy of the two molecules is first calculated as their combined internal energy plus their combined kinetic energy in the CM coordinate frame. Chemical reactions are triggered when this energy is in excess of the activation energy for the reaction. In this case the enthalpy of the reaction is added to the total energy. This energy is then redistributed between the degrees of freedom of the product molecules according to the following scheme:<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ energy = KE + IE + enthalpy \]" src="form_23.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ dof_A = DOF(Cp_A) \]" src="form_52.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ dof_B = DOF(Cp_B) \]" src="form_53.png">
<p>
<p>
where <img class="formulaInl" alt="$dof_X$" src="form_26.png"> are total degrees of freedom (kinetic + internal) for molecule X=(A,B), and <img class="formulaInl" alt="$Cp_X$" src="form_27.png"> is the specific heat of molecule X. The function <a class="el" href="def_8h.html#209720e83dae866cf7ca0973c6fc074a">DOF(Cp)</a> of coputing the degrees of freedom from the specific heat is defined as:<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ DOF = 3 + (2Cv/R-3)/2 = 3 + Cv/R - 1.5 = Cv/R + 1.5 = Cp/R + 0.5 \]" src="form_54.png">
<p>
<p>
where <img class="formulaInl" alt="$Cv = Cp - R$" src="form_55.png"><p>
The combined kinetic degrees of freedom are 6, then the combined internal degrees of freedom are calculated as:<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[dofi = dof-6 \]" src="form_56.png">
<p>
<p>
Then for each molecule the ratio of its internal degrees of freedom to the total internal degrees of freedom is computed as:<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ rdofi_A = (dof_A - 3)/dofi \]" src="form_57.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ rdofi_B = 1 - rdofi_A \]" src="form_58.png">
<p>
<p>
The calculations of energy redistribution between colliding molecules is done in the center-of-mass system (CM). The number of kinetic (translational) degrees of freedom of two colliding molecules in CM system (<img class="formulaInl" alt="$dofk_{CM}$" src="form_59.png">) will be less than that in the laboratory system, since the CM system already has 3 translational degrees of freedom associated with its center of mass. Thus, the total number of kinetic degrees of freedom in CM system will be:<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ dofk_{CM} = 6 - 3 = 3 \]" src="form_60.png">
<p>
<p>
And the total number of dof in the CM system will be reduced accordingly: <img class="formulaInl" alt="$dof_{CM} = dof - 3$" src="form_61.png">. The number of internal degrees of freedom in CM system remain the same as in the laboratory system: <img class="formulaInl" alt="$dofi_{CM} = dofi$" src="form_62.png">.<p>
The procedure for calculating new velocities and internal energies in CM system during the collision of two molecules ('a' and 'b') is as follows:<p>
<ul>
<li>The old kinetic energy of the two molecules are computed as:</li></ul>
<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ ke_{old} = \frac{ua_{old}^2}{2} + \frac{ub_{old}^2}{2} \]" src="form_63.png">
<p>
<p>
<ul>
<li>It is combined with the old internal energy to form the new total energy in CM system as:</li></ul>
<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ e_{old} = ke_{old} + iea + ieb \]" src="form_64.png">
<p>
<p>
where iea, ieb are the internal energies of molecules <img class="formulaInl" alt="$a$" src="form_65.png"> and <img class="formulaInl" alt="$b$" src="form_66.png"> respectively.<p>
<ul>
<li>The new combined energy (e) of the two molecules is calculated by adding the enthalpy of reaction (h) to the old total energy:</li></ul>
<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ e = e_{old} + h \]" src="form_67.png">
<p>
<p>
<ul>
<li>Kinetic energy in the CM system is computed as the share of the new total energy distributed according to degrees of freedom:</li></ul>
<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ ke = \frac{dofk_{CM}}{dof_{CM}}\,e \]" src="form_68.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ ie = energy - ke \]" src="form_32.png">
<p>
<p>
<ul>
<li>The new velocities of the molecules in the CM frame are then updated from the old ones. The old velocities were computed according the elastic collision scheme between two hard-balls. So, if the energy was released or absorbed during the reaction, and some of it was absorbed into the internal degrees of freedom, the old velocities should be recalculated. The kinetic-energy is redistributed equally between the two molecules:</li></ul>
<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\frac{ma\,ua^2}{2} = \frac{mb\,ub^2}{2} = \frac{ke}{2} \]" src="form_69.png">
<p>
<p>
which gives:<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ ua = \sqrt{ke/ma} \]" src="form_70.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ ub = \sqrt{ke/mb} \]" src="form_71.png">
<p>
<p>
This is used to build the ratio of new to old velocities (see interact(...) function in <a class="el" href="domain_8cc.html" title="Implementation of Domain and Boundary classes.">domain.cc</a>):<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ uratio_A = ua/ua_{old} \]" src="form_72.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ uratio_B = ub/ub_{old} \]" src="form_73.png">
<p>
<p>
which are used to update the velocity vector for each molecule as:<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ u_X(i) = u_X(i)*uratio_X \]" src="form_39.png">
<p>
<p>
where i=(x,y,z) is the Cartesian direction of velocity vector. The remaining internal energy, ie, is distribued among the internal degrees of freedom of each molecule X as:<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ InternalEnergy_X = rdofi_X\,ie \]" src="form_74.png">
<p>
<p>
It should be noted, that in the above calculations, the value of kinetic energy was that computed in CM frame of referecne. This means that he actual kinetic energy of the molecule will have a somewhat higher value that what would be expected from an equal distribution of energy among the internal and exeternal degrees of freedom. Nevertheles, this scheme is considered accurate, since the resistribution of energy is indeed taking place in the center-of-mass reference frame, and this will inevitably lead to a higher contribution of energy to kinetic degrees of freedom.<h3><a class="anchor" name="SSec">
Cross-Boundary Species</a></h3>
The code provides the possibility of specifying cross-boundary gases, which can enter the computational domain from the other side of the open boundary (the boundary with the type="open" inside the <code>&lt;boundary&gt;</code> tag of the XML input file (see Sec.<a class="el" href="Configfile.html#SecConfig">Configuration File</a>).<p>
The algorithm uses the density and temperature to calculate the frequency of injection of molecules of specie, <img class="formulaInl" alt="$s$" src="form_3.png"> at the boundary. The injection frequency, <img class="formulaInl" alt="$f_s$" src="form_4.png"> per unit area, <img class="formulaInl" alt="$A$" src="form_1.png"> is computed as <p class="formulaDsp">
<img class="formulaDsp" alt="\[ f_s = \frac{N}{\Delta\,t} \]" src="form_5.png">
<p>
 where <img class="formulaInl" alt="$\Delta\,t_s$" src="form_6.png"> is the time interval at which a molecule hits the boundary area <img class="formulaInl" alt="$A$" src="form_1.png">, and <img class="formulaInl" alt="$N$" src="form_7.png"> is the number of molecules in a volume with the base <img class="formulaInl" alt="$A$" src="form_1.png"> and length <img class="formulaInl" alt="$\Delta\,x$" src="form_18.png"> as shown in the figure: <div align="center">
<img src="injectionfrequency.png" alt="injectionfrequency.png">
<p><strong>'</strong></p></div>
 The time inteval, <img class="formulaInl" alt="$\Delta\,t$" src="form_9.png">, between the collisions can be related to the component of velocity of the molecule of species <img class="formulaInl" alt="$s$" src="form_3.png">, in direction <img class="formulaInl" alt="$x$" src="form_10.png">, <img class="formulaInl" alt="$v_{sx}$" src="form_11.png">, as follows: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Delta\,t = \frac{2\Delta\,x}{v_{sx}} \]" src="form_19.png">
<p>
 The number of molecules, <img class="formulaInl" alt="$N$" src="form_7.png"> can be related to density, <img class="formulaInl" alt="$\rho$" src="form_13.png">, as: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ N = \frac{\rho}{\mu}\Delta\,x\,A \]" src="form_20.png">
<p>
 where <img class="formulaInl" alt="$\mu$" src="form_15.png"> is the mass of one molecule and <img class="formulaInl" alt="$A = \Delta\,y\,\Delta\,z$" src="form_21.png">. Thus, the frequency is: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ f_s = \frac{\rho}{\mu}\Delta\,x\,A\frac{v_{sx}}{2\Delta\,x} = \frac{\rho\,v_{sx}}{2\mu}A \]" src="form_22.png">
<p>
 </div>
<hr size="1"><address style="text-align: right;"><small>Generated on Tue May 26 16:10:36 2009 for ReMoDy by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7.1 </small></address>
</body>
</html>
